Fperm.fd                 package:fda                 R Documentation

_P_e_r_m_u_t_a_t_i_o_n _F-_t_e_s_t _f_o_r _f_u_n_c_t_i_o_n_a_l _l_i_n_e_a_r _r_e_g_r_e_s_s_i_o_n.

_D_e_s_c_r_i_p_t_i_o_n:

     Fperm.fd creates a null distribution for a test of no effect in
     functional linear regression. It makes generic use of 'fRegress'
     and permutes the 'yfdPar' input.

_U_s_a_g_e:

     Fperm.fd(yfdPar, xfdlist, betalist,wt=NULL,
                 nperm=200,argvals=NULL,q=0.95,plotres=TRUE)

_A_r_g_u_m_e_n_t_s:

  yfdPar: the dependent variable object.  It may be an object of three
          possible classes:

        _v_e_c_t_o_r if the dependent variable is scalar.

        _f_d a functional data object if the dependent variable is
             functional.

        _f_d_P_a_r a functional parameter object if the dependent variable
             is functional, and if it is necessary to smooth the
             prediction of the dependent variable.


 xfdlist: a list of length equal to the number of independent
          variables. Members of this list are the independent
          variables.  They be objects of either of these two classes:


             *  a vector if the independent dependent variable is
                scalar.

             *  a functional data object if the dependent variable is
                functional.

          In either case, the object must have the same number of
          replications as the dependent variable object.  That is, if
          it is a scalar, it must be of the same length as the
          dependent variable, and if it is functional, it must have the
          same number of replications as the dependent variable. 

betalist: a list of length equal to the number of independent
          variables. Members of this list define the regression
          functions to be estimated. They are functional parameter
          objects.  Note that even if corresponding independent
          variable is scalar, its regression coefficient will be
          functional if the dependent variable is functional.  Each of
          these functional parameter objects defines a single
          functional data object, that is, with only one replication. 

      wt: weights for weighted least squares, defaults to all 1. 

   nperm: number of permutations to use in creating the null
          distribution. 

 argvals: If 'yfdPar' is a 'fd' object, the points at which to evaluate
          the point-wise F-statistic. 

       q: Critical quantile of the null distribution to compare to the
          observed F-statistic. 

 plotres: Argument to plot a visual display of the null distribution
          displaying the 'q'th quantile and observed F-statistic. 

_D_e_t_a_i_l_s:

     An F-statistic is calculated as the ratio of residual variance to
     predicted variance. The observed F-statistic is returned along
     with the permutation distribution.

     If 'yfdPar' is a 'fd' object, the maximal value of the pointwise
     F-statistic is calculated. The pointwise F-statistics are also
     returned.

     The default of setting 'q = 0.95' is, by now, fairly standard. The
     default 'nperm = 200' may be small, depending on the amount of
     computing time available.

     If 'argvals' is not specified and 'yfdPar' is a 'fd' object, it
     defaults to 101 equally-spaced points on the range of 'yfdPar'.

_V_a_l_u_e:

     A list with components 

    pval: the observed p-value of the permutation test.

    qval: the 'q'th quantile of the null distribution.

    Fobs: the observed maximal F-statistic.

   Fnull: a vector of length 'nperm' giving the observed values of the
          permutation distribution. 

   Fvals: the pointwise values of the observed F-statistic.

Fnullvals: the pointwise values of of the permutation observations. 

pvals.pts: pointwise p-values of the F-statistic.

qvals.pts: pointwise 'q'th quantiles of the null distribution 

fRegressList: the result of 'fRegress' on the observed data 

 argvals: argument values for evaluating the F-statistic if 'yfdPar' is
          a functional data object. 

     normal-bracket70bracket-normal

_S_o_u_r_c_e:

     Ramsay, James O., and Silverman, Bernard W. (2006), _Functional
     Data Analysis, 2nd ed._, Springer, New York.

_S_e_e _A_l_s_o:

     'fRegress' 'Fstat.fd'

