bsplinepen                package:fda                R Documentation

_B-_S_p_l_i_n_e _P_e_n_a_l_t_y _M_a_t_r_i_x

_D_e_s_c_r_i_p_t_i_o_n:

     Computes the matrix defining the roughness penalty for functions
     expressed in terms of a B-spline basis.

_U_s_a_g_e:

     bsplinepen(basisobj, Lfdobj=2, rng=basisobj$rangeval)

_A_r_g_u_m_e_n_t_s:

basisobj: a B-spline basis object. 

  Lfdobj: either a nonnegative integer or a linear differential
          operator object. 

     rng: a vector of length 2 defining range over which the basis
          penalty is to be computed. 

_D_e_t_a_i_l_s:

     A roughness penalty for a function $x(t)$ is defined by
     integrating the square of either the derivative of $x(t)$ or, more
     generally, the result of applying a linear differential operator
     $L$ to it.  The most common roughness penalty is the integral of
     the square of the second derivative, and this is the default. To
     apply this roughness penalty, the matrix of inner products of the
     basis functions (possibly after applying the linear differential
     operator to them) defining this function is necessary. This
     function just calls the roughness penalty evaluation function
     specific to the basis involved.

_V_a_l_u_e:

     a symmetric matrix of order equal to the number of basis functions
     defined by the B-spline basis object.  Each element is the inner
     product of two B-spline basis functions after applying the
     derivative or linear differential operator defined by 'Lfdobj'.

_E_x_a_m_p_l_e_s:

     ##
     ## bsplinepen with only one basis function
     ##
     bspl1.1 <- create.bspline.basis(nbasis=1, norder=1)
     pen1.1 <- bsplinepen(bspl1.1, 0) 

     ##
     ## bspline pen for a cubic spline with knots at seq(0, 1, .1)
     ##
     basisobj <- create.bspline.basis(c(0,1),13)
     #  compute the 13 by 13 matrix of inner products of second derivatives
     penmat <- bsplinepen(basisobj)

