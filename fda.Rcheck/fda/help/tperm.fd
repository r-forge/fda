tperm.fd                 package:fda                 R Documentation

_P_e_r_m_u_t_a_t_i_o_n _t-_t_e_s_t _f_o_r _t_w_o _g_r_o_u_p_s _o_f _f_u_n_c_t_i_o_n_a_l _d_a_t_a _o_b_j_e_c_t_s.

_D_e_s_c_r_i_p_t_i_o_n:

     tperm.fd creates a null distribution for a test of no difference
     between two groups of functional data objects.

_U_s_a_g_e:

      tperm.fd(x1fd, x2fd, nperm=200, q=0.05, argvals=NULL, plotres=TRUE,...)

_A_r_g_u_m_e_n_t_s:

    x1fd: a functional data object giving the first group of functional
          observations. 

    x2fd: a functional data object giving the second group of
          functional observations. 

   nperm: number of permutations to use in creating the null
          distribution. 

 argvals: If 'yfdPar' is a 'fd' object, the points at which to evaluate
          the point-wise F-statistic. 

       q: Critical upper-tail quantile of the null distribution to
          compare to the observed F-statistic. 

 plotres: Argument to plot a visual display of the null distribution
          displaying the '1-q'th quantile and observed F-statistic. 

     ...: Additional plotting arguments that can be used with 'plot'. 

_D_e_t_a_i_l_s:

     The usual t-statistic is calculated pointwise and the test based
     on the maximal value. If 'argvals' is not specified, it defaults
     to 101 equally-spaced points on the range of 'yfdPar'.

_V_a_l_u_e:

     A list with components 

    pval: the observed p-value of the permutation test.

    qval: the 'q'th quantile of the null distribution.

    Tobs: the observed maximal t-statistic.

   Tnull: a vector of length 'nperm' giving the observed values of the
          permutation distribution. 

   Tvals: the pointwise values of the observed t-statistic.

Tnullvals: the pointwise values of of the permutation observations.

pvals.pts: pointwise p-values of the t-statistic.

qvals.pts: pointwise 'q'th quantiles of the null distribution

 argvals: argument values for evaluating the F-statistic if 'yfdPar'is
          a functional data object. 

     normal-bracket50bracket-normal

_S_i_d_e _E_f_f_e_c_t_s:

     a plot of the functional observations

_S_o_u_r_c_e:

     Ramsay, James O., and Silverman, Bernard W. (2006), _Functional
     Data Analysis, 2nd ed._, Springer, New York.

_S_e_e _A_l_s_o:

     'fRegress' 'Fstat.fd'

_E_x_a_m_p_l_e_s:

      
     # This tests the difference between boys and girls heights in the Berkeley
     # growth data.

     # First set up a basis system to hold the smooths

     knots  <- growth$age
     norder <- 6
     nbasis <- length(knots) + norder - 2
     hgtbasis <- create.bspline.basis(range(knots), nbasis, norder, knots)

     # Now smooth with a fourth-derivative penalty and a very small smoothing
     # parameter

     Lfdobj <- 4
     lambda <- 1e-2
     growfdPar <- fdPar(hgtbasis, Lfdobj, lambda)

     hgtmfd <- smooth.basis(growth$age, growth$hgtm, growfdPar)$fd
     hgtffd <- smooth.basis(growth$age, growth$hgtf, growfdPar)$fd

     # Call tperm.fd

     tres <- tperm.fd(hgtmfd,hgtffd)

